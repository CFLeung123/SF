# Define the input text
input_text = """
p_11(L=4)=  -3.33731709500960503922571796168356568e-02

p_11(L=5)=  -3.8194416725288735839314166308449674e-02

p_11(L=6)=  -4.23270305725300590187422991646086607e-02

p_11(L=7)=  -4.55582667062665982330940458592186249e-02

p_11(L=8)=  -4.80630845295556027486767523990664134e-02

p_11(L=9)=  -5.00500266852094518210374843987829592e-02

p_11(L=10)=  -5.16759271044636090039442660887094134e-02

p_11(L=11)=  -5.30456319780481912119773003954576724e-02

p_11(L=12)=  -5.42275054377953110451324220301304696e-02

p_11(L=13)=  -5.52667422858670638923700694869375925e-02

p_11(L=14)=  -5.61941477383489537517434898991908619e-02
 
p_11(L=15)=  -5.70314828383427675278992301304407605e-02

p_11(L=16)=  -5.779466113962379058013248880393873e-02

p_11(L=17)=  -5.84956822208042405071862880767196223e-02

p_11(L=18)=  -5.91438324234176135627258885244151703e-02

p_11(L=19)=  -5.97464556259825257183214465107877046e-02

p_11(L=20)=  -6.03094653748051166972904888101458274e-02

p_11(L=21)=  -6.08376964442055086813103728803721754e-02

p_11(L=22)=  -6.1335153316879976672021084026465587e-02

p_11(L=23)=  -6.18051903151198238952032463332038232e-02

p_11(L=24)=  -6.22506450537315848354331448050562885e-02

p_11(L=25)=  -6.26739391726654218109369681373311283e-02

p_11(L=26)=  -6.30771556080784865335952835290689985e-02

p_11(L=27)=  -6.34620987073679774157710975707414884e-02

p_11(L=28)=  -6.38303415831012023348430711964546499e-02

p_11(L=29)=  -6.41832638317037457811891675354968312e-02

p_11(L=30)=  -6.45220818798868849900171724715955846e-02

p_11(L=31)=  -6.48478736228884059885390553436268251e-02

p_11(L=32)=  -6.51615985953036323513824157530717477e-02

p_11(L=33)=  -6.54641146112608516851474153231997317e-02

p_11(L=34)=  -6.57561915891876184327634469325826566e-02

p_11(L=35)=  -6.60385231129320358568639371835730277e-02

p_11(L=36)=  -6.63117361589264672984980127781227759e-02

p_11(L=37)=  -6.65763993269436122505617111613385111e-02

p_11(L=38)=  -6.6833029841766928433456576464391007e-02

p_11(L=39)=  -6.7082099539080196509617316465529474e-02

p_11(L=40)=  -6.7324040006980243947634200278219828e-02

p_11(L=41)=  -6.75592470217576140163554779220891629e-02

p_11(L=42)=  -6.77880843907883245266641841332799e-02

p_11(L=43)=  -6.80108872949169879384063835631996481e-02

p_11(L=44)=  -6.82279652063767392865087963908320124e-02

p_11(L=45)=  -6.84396044451715175080201935354410035e-02

p_11(L=46)=  -6.86460704262471523764008982065594831e-02

p_11(L=47)=  -6.88476096411678627987620168710552233e-02

p_11(L=48)=  -6.90444514109842429837781284384907336e-02

p_11(L=49)=  -6.92368094412093729684848829488745408e-02
 
p_11(L=50)=  -6.94248832050627456759013077987781659e-02

p_11(L=51)=  -6.96088591772018981696756917255204844e-02

p_11(L=52)=  -6.97889119368845790025305046038389606e-02

p_11(L=53)=  -6.99652051567673003311163845263543338e-02

p_11(L=54)=  -7.01378924912512338138083358012649631e-02

p_11(L=55)=  -7.03071183763549738755881044260574859e-02

p_11(L=56)=  -7.04730187514622962953306188269151919e-02

p_11(L=57)=  -7.06357217119103165132558756626949143e-02

p_11(L=58)=  -7.07953481002076112081058315465331795e-02

p_11(L=59)=  -7.09520120426687705619883866457975343e-02

p_11(L=60)=  -7.11058214373934986524208880110598019e-02

p_11(L=61)=  -7.1256878398781724469001814208918396e-02

p_11(L=62)=  -7.14052796631421784024447848028515645e-02

p_11(L=63)=  -7.15511169594047332838469058546110079e-02

p_11(L=64)=  -7.16944773484733620524892663716099713e-02
"""

#Extrapolation
using DoubleFloats
using Quadmath
const delta = 1
const Lmin = 4

# Extract the numbers using a regular expression
f = [parse(Float128, match(r"[-+]?\d*\.\d+([eE][-+]?\d+)?", line).match) for line in split(input_text, '\n') if match(r"[-+]?\d*\.\d+([eE][-+]?\d+)?", line)!==nothing]

print(f)


function R0(f)
    R0f = Array{Float128}(undef, length(f) - delta)
    for i in 1:length(f)-delta
        L = i - 1 + Lmin
        R0f[i] = Float128(L / delta) * (f[i+delta] - f[i])
    end
    return R0f
end

function Rnu(nu, f)
    Rnuf = Array{Float128}(undef, length(f) - delta)
    for i in 1:length(f)-delta
        L = i - 1 + Lmin
        Rnuf[i] = f[i] + Float128(L / (nu * delta)) * (f[i+delta] - f[i])
    end
    return Rnuf
end

function extrapolationf(f)
    final =Rnu(5,Rnu(5,Rnu(4,Rnu(4,Rnu(3,Rnu(3,Rnu(2, Rnu(2, Rnu(1, Rnu(1, R0(f)))))))))))

    for l in 1:length(final)
        @inbounds begin
            L = l - 1 + Lmin
            println(' ')
            println("Final(L=$L)= ", final[l])
            println("Abs error=  ", final[l] + 1 / (12 * Float128(pi)^2))
            println("%error=  ", 100 * (final[l] * (-12 * Float128(pi)^2) - 1))
        end
    end
end

extrapolationf(f)
println(" -------------------------------------------------------- ")
