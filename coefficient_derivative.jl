# Define the input text
input_text = """
dot(p)_11(L=4)=  2.37758421316922647916062312867930935e-02

dot(p)_11(L=5)=  3.05710921426044853940079887666465281e-02

dot(p)_11(L=6)=  3.70740823740888376136488973354088395e-02

dot(p)_11(L=7)=  4.3443295707055599741129898135808577e-02

dot(p)_11(L=8)=  4.97128477932682535925401847362274016e-02

dot(p)_11(L=9)=  5.58998839162474205511626390876930273e-02

dot(p)_11(L=10)=  6.20202308772256725025364147050000105e-02

dot(p)_11(L=11)=  6.8087974386950832155272148268885503e-02

dot(p)_11(L=12)=  7.41145165384318263808971471166537016e-02

dot(p)_11(L=13)=  8.01086205808739178271845245156491279e-02

dot(p)_11(L=14)=  8.60768991945804850428674958157033235e-02

dot(p)_11(L=15)=  9.20243464528255099728071048483636096e-02

dot(p)_11(L=16)=  9.79547728249562673012773002802988402e-02

dot(p)_11(L=17)=  1.0387112618557223817198657036217437e-01

dot(p)_11(L=18)=  1.09775720083966838142546228082441603e-01

dot(p)_11(L=19)=  1.15670394967633311817789725522984537e-01

dot(p)_11(L=20)=  1.21556632946476828345877640177676944e-01

dot(p)_11(L=21)=  1.27435640656040155517908403032699259e-01

dot(p)_11(L=22)=  1.33308410063718284293421429349301258e-01

dot(p)_11(L=23)=  1.39175763805393062227093460243410661e-01

dot(p)_11(L=24)=  1.4503838948893303312171546902174944e-01

dot(p)_11(L=25)=  1.50896865995395907899863901799267093e-01

dot(p)_11(L=26)=  1.56751683884543087334816992011933228e-01

dot(p)_11(L=27)=  1.62603261394755183965884496347584021e-01

dot(p)_11(L=28)=  1.68451957108878802082638113782200073e-01

dot(p)_11(L=29)=  1.74298080068166713038821606997181737e-01

dot(p)_11(L=30)=  1.80141897912944113200957922420590934e-01

dot(p)_11(L=31)=  1.85983643483238531351954134434659796e-01

dot(p)_11(L=32)=  1.91823520207257297056305819570016132e-01

dot(p)_11(L=33)=  1.9766170652830102808894762698968688e-01

dot(p)_11(L=34)=  2.03498359563342000756241826220090482e-01

dot(p)_11(L=35)=  2.09333618143506791283124909744116866e-01

dot(p)_11(L=36)=  2.15167605354157980343498107757319834e-01

dot(p)_11(L=37)=  2.21000430667443166610906538029795585e-01

dot(p)_11(L=38)=  2.2683219174108419451671547295880214e-01

dot(p)_11(L=39)=  2.32662975942359715314089928253207104e-01

dot(p)_11(L=40)=  2.38492861644696519714068703563901212e-01

dot(p)_11(L=41)=  2.44321919335202532424309180590681337e-01

dot(p)_11(L=42)=  2.50150212564294902121968709385820352e-01

dot(p)_11(L=43)=  2.55977798762891505212318003621185473e-01

dot(p)_11(L=44)=  2.61804729948040982693700450064070829e-01

dot(p)_11(L=45)=  2.67631053334257606235727619826166802e-01

dot(p)_11(L=46)=  2.73456811864790124960807598779770331e-01

dot(p)_11(L=47)=  2.79282044674734023224897170212157788e-01

dot(p)_11(L=48)=  2.85106787495870591977042358338636672e-01

dot(p)_11(L=49)=  2.90931073011563124580190369173381691e-01

dot(p)_11(L=50)=  2.96754931168667713738432969874803412e-01

dot(p)_11(L=51)=  3.02578389452399570031405134863841239e-01

dot(p)_11(L=52)=  3.08401473129111846099975342685473479e-01

dot(p)_11(L=53)=  3.14224205461257875473194582804361957e-01

dot(p)_11(L=54)=  3.20046607898150484482785693070444376e-01

dot(p)_11(L=55)=  3.25868700245607318836609376677329031e-01

dot(p)_11(L=56)=  3.31690500817142063120837436449252247e-01

dot(p)_11(L=57)=  3.37512026568975248154322158826555217e-01

dot(p)_11(L=58)=  3.43333293220842756057510925064553551e-01

dot(p)_11(L=59)=  3.49154315364290949768582400705073441e-01

dot(p)_11(L=60)=  3.54975106559928991801331453559994374e-01

dot(p)_11(L=61)=  3.60795679424932470454231779769741729e-01

dot(p)_11(L=62)=  3.66616045711895172149529388996715994e-01

dot(p)_11(L=63)=  3.72436216380016575125264039248308142e-01

dot(p)_11(L=64)=  3.7825620165944323154080684424648982e-01
"""

#Extrapolation
using DoubleFloats
using Quadmath
const delta = 1
const Lmin = 4

# Extract the numbers using a regular expression
f = [parse(Float128, match(r"[-+]?\d*\.\d+([eE][-+]?\d+)?", line).match) for line in split(input_text, '\n') if match(r"[-+]?\d*\.\d+([eE][-+]?\d+)?", line)!==nothing]

print(f)


function R0(f)
    R0f = Array{Float128}(undef, length(f) - delta)
    for i in 1:length(f)-delta
        L = Lmin -1 +i
        R0f[i] = Float128(L / delta) * (f[i+delta] - f[i])
    end
    return R0f
end

function Rnu(nu, f)
    Rnuf = Array{Float128}(undef, length(f) - delta)
    for i in 1:length(f)-delta
        L = Lmin -1 +i
        Rnuf[i] = f[i] + Float128(L / (nu * delta)) * (f[i+delta] - f[i])
    end
    return Rnuf
end

function scale(f)
    for i in 1:length(f)
        L = Lmin -1+i
        f[i] = (1+1/Float128(2L))*f[i]
    end
    return f
end

function extrapolationf(f)
    final = Rnu(2,Rnu(2,Rnu(1,Rnu(1,R0(f)))))
    println("final = Rnu(2,Rnu(2,Rnu(1,Rnu(1,R0(f)))))")
    for l in 1:length(final)
        @inbounds begin
            L = l - 1 + Lmin
            println(' ')
            println("Final(L=$L)= ", final[l])

        end
    end
end

for i in 1:length(f)
    L = Lmin-1+i
    f[i] = f[i] / L
    println(' ')
    println("f(L=$L)/L= ", f[i])
end

println(" -------------------------------------------------------- ")
extrapolationf(f)
